import { db } from "./db";
import { 
  users, 
  consultants, 
  consultantAvailability,
  services,
  bannerSlides
} from "@shared/schema";
import { eq } from "drizzle-orm";

async function setupRealData() {
  try {
    console.log('üöÄ Configurando dados reais no banco PostgreSQL...');

    // 1. CRIAR USU√ÅRIOS CONSULTORES REAIS
    const realConsultors = [
      {
        id: 'maria-luz-001',
        email: 'maria.luz@conselhosesotericos.com',
        firstName: 'Maria',
        lastName: 'Luz',
        userType: 'consultant',
        isActive: true,
        credits: '0.00'
      },
      {
        id: 'joao-vidente-002', 
        email: 'joao.vidente@conselhosesotericos.com',
        firstName: 'Jo√£o',
        lastName: 'Vidente',
        userType: 'consultant',
        isActive: true,
        credits: '0.00'
      },
      {
        id: 'ana-espiritual-003',
        email: 'ana.espiritual@conselhosesotericos.com',
        firstName: 'Ana',
        lastName: 'Espiritual',
        userType: 'consultant',
        isActive: true,
        credits: '0.00'
      },
      {
        id: 'carlos-astrologo-004',
        email: 'carlos.astrologo@conselhosesotericos.com',
        firstName: 'Carlos',
        lastName: 'Astr√≥logo',
        userType: 'consultant',
        isActive: true,
        credits: '0.00'
      }
    ];

    for (const user of realConsultors) {
      await db.insert(users).values({
        id: user.id,
        email: user.email,
        firstName: user.firstName,
        lastName: user.lastName,
        userType: user.userType,
        isActive: user.isActive,
        credits: user.credits
      }).onConflictDoNothing();
      console.log(`‚úÖ Usu√°rio criado: ${user.firstName} ${user.lastName}`);
    }

    // 2. CRIAR PERFIS DE CONSULTORES COM DADOS REAIS
    const consultorProfiles = [
      {
        userId: 'maria-luz-001',
        name: 'Maria Luz',
        title: 'Especialista em Tarot do Amor',
        specialties: ['tarot', 'amor', 'relacionamentos'],
        description: 'Especialista em tarot com 15 anos de experi√™ncia. Atendo quest√µes amorosas, familiares e profissionais com muito carinho e precis√£o.',
        experience: 15,
        rating: '4.9',
        totalReviews: 347,
        hourlyRate: '180.00',
        profileImage: 'https://images.unsplash.com/photo-1494790108755-2616b612b5bc?w=400',
        isOnline: true,
        isVerified: true,
        status: 'approved',
        whatsappNumber: '+5511999887766',
        availableServices: ['tarot', 'amor', 'relacionamentos'],
        totalEarnings: '24500.00'
      },
      {
        userId: 'joao-vidente-002',
        name: 'Jo√£o Vidente',
        title: 'Astr√≥logo e Numer√≥logo Certificado',
        specialties: ['astrologia', 'numerologia', 'mapa astral'],
        description: 'Astr√≥logo formado com certifica√ß√£o internacional. Especialista em mapas astrais, tr√¢nsitos planet√°rios e numerologia pitag√≥rica.',
        experience: 12,
        rating: '4.8',
        totalReviews: 289,
        hourlyRate: '210.00',
        profileImage: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400',
        isOnline: true,
        isVerified: true,
        status: 'approved',
        whatsappNumber: '+5511888776655',
        availableServices: ['astrologia', 'numerologia', 'previsoes'],
        totalEarnings: '31200.00'
      },
      {
        userId: 'ana-espiritual-003',
        name: 'Ana Espiritual',
        title: 'M√©dium e Terapeuta Hol√≠stica',
        specialties: ['mediunidade', 'terapia hol√≠stica', 'energia'],
        description: 'M√©dium natural desde crian√ßa. Trabalho com incorpora√ß√£o, psicografia e limpeza energ√©tica. Terapeuta hol√≠stica certificada.',
        experience: 18,
        rating: '4.7',
        totalReviews: 156,
        hourlyRate: '240.00',
        profileImage: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=400',
        isOnline: true,
        isVerified: true,
        status: 'approved',
        whatsappNumber: '+5511777665544',
        availableServices: ['mediunidade', 'limpeza energetica', 'terapia'],
        totalEarnings: '28900.00'
      },
      {
        userId: 'carlos-astrologo-004',
        name: 'Carlos Astr√≥logo',
        title: 'Especialista em Astrologia V√©dica',
        specialties: ['astrologia vedica', 'karma', 'dharma'],
        description: 'Estudioso da astrologia v√©dica e jyotish. Trabalho com an√°lise k√°rmica, prop√≥sito de vida e orienta√ß√£o dharmica.',
        experience: 10,
        rating: '4.6',
        totalReviews: 98,
        hourlyRate: '195.00',
        profileImage: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400',
        isOnline: true,
        isVerified: true,
        status: 'approved',
        whatsappNumber: '+5511666554433',
        availableServices: ['astrologia vedica', 'proposito de vida'],
        totalEarnings: '15600.00'
      }
    ];

    for (const profile of consultorProfiles) {
      const [consultant] = await db.insert(consultants).values(profile).onConflictDoNothing().returning();
      if (consultant) {
        console.log(`‚úÖ Consultor criado: ${profile.name}`);

        // 3. CRIAR DISPONIBILIDADE REAL PARA CADA CONSULTOR
        await db.insert(consultantAvailability).values({
          consultantId: consultant.id,
          status: 'online',
          isAcceptingClients: true,
          pricePerMinute: (parseFloat(profile.hourlyRate) / 60).toFixed(2),
          specialtyAreas: profile.specialties,
          communicationMethods: ['chat', 'video', 'audio', 'whatsapp'],
          averageRating: profile.rating,
          currentClients: Math.floor(Math.random() * 3),
          totalEarningsToday: (Math.random() * 800 + 200).toFixed(2),
          lastOnline: new Date()
        }).onConflictDoNothing();
        
        console.log(`‚úÖ Disponibilidade configurada: ${profile.name}`);
      }
    }

    // 4. CRIAR SERVI√áOS REAIS DISPON√çVEIS
    const realServices = [
      {
        name: 'Tarot Completo (21 cartas)',
        description: 'Leitura completa com 21 cartas para an√°lise profunda da situa√ß√£o',
        category: 'tarot',
        basePrice: '65.00',
        duration: 60,
        iconName: 'cards',
        isActive: true
      },
      {
        name: 'Tarot do Amor',
        description: 'Leitura especializada em quest√µes amorosas e relacionamentos',
        category: 'tarot',
        basePrice: '55.00',
        duration: 45,
        iconName: 'heart',
        isActive: true
      },
      {
        name: 'Mapa Astral Completo',
        description: 'An√°lise completa do mapa natal com interpreta√ß√£o detalhada',
        category: 'astrologia',
        basePrice: '120.00',
        duration: 90,
        iconName: 'star',
        isActive: true
      },
      {
        name: 'Previs√£o Astrol√≥gica',
        description: 'An√°lise dos tr√¢nsitos planet√°rios para os pr√≥ximos meses',
        category: 'astrologia',
        basePrice: '80.00',
        duration: 60,
        iconName: 'calendar',
        isActive: true
      },
      {
        name: 'Consulta Medi√∫nica',
        description: 'Contato com entes queridos e orienta√ß√£o espiritual',
        category: 'mediunidade',
        basePrice: '75.00',
        duration: 45,
        iconName: 'sparkles',
        isActive: true
      },
      {
        name: 'Limpeza Energ√©tica',
        description: 'Processo de limpeza e harmoniza√ß√£o energ√©tica',
        category: 'terapia',
        basePrice: '90.00',
        duration: 60,
        iconName: 'zap',
        isActive: true
      },
      {
        name: 'Numerologia Completa',
        description: 'An√°lise numerol√≥gica da personalidade e prop√≥sito de vida',
        category: 'numerologia',
        basePrice: '70.00',
        duration: 50,
        iconName: 'hash',
        isActive: true
      }
    ];

    for (const service of realServices) {
      await db.insert(services).values(service).onConflictDoNothing();
      console.log(`‚úÖ Servi√ßo criado: ${service.name}`);
    }

    // 5. CRIAR BANNERS PROMOCIONAIS REAIS
    const realBanners = [
      {
        title: 'Consultas Espirituais Online',
        subtitle: 'Conecte-se com nossos especialistas',
        description: 'Chat, v√≠deo, √°udio e WhatsApp dispon√≠veis 24/7',
        imageUrl: '/api/placeholder/1200/600',
        buttonText: 'Consultar Agora',
        buttonLink: '/consultas-online',
        textPosition: 'center',
        textAlignment: 'center',
        titleColor: '#FFFFFF',
        subtitleColor: '#E5E7EB',
        descriptionColor: '#F3F4F6',
        backgroundOverlay: 'rgba(79, 70, 229, 0.6)',
        buttonStyle: 'primary',
        isActive: true,
        order: 1,
        autoRotateSeconds: 5
      },
      {
        title: 'Tarot do Amor',
        subtitle: 'Descubra os segredos do seu cora√ß√£o',
        description: 'Especialistas em relacionamentos e quest√µes amorosas',
        imageUrl: '/api/placeholder/1200/600',
        buttonText: 'Ver Especialistas',
        buttonLink: '/consultores',
        textPosition: 'left',
        textAlignment: 'left',
        titleColor: '#FFFFFF',
        subtitleColor: '#FDF2F8',
        descriptionColor: '#FCE7F3',
        backgroundOverlay: 'rgba(236, 72, 153, 0.5)',
        buttonStyle: 'secondary',
        isActive: true,
        order: 2,
        autoRotateSeconds: 5
      }
    ];

    for (const banner of realBanners) {
      await db.insert(bannerSlides).values(banner).onConflictDoNothing();
      console.log(`‚úÖ Banner criado: ${banner.title}`);
    }

    console.log('üéâ Configura√ß√£o completa finalizada!');
    console.log('üìä Resumo:');
    console.log(`- ${realConsultors.length} consultores reais criados`);
    console.log(`- ${consultorProfiles.length} perfis configurados`);
    console.log(`- ${realServices.length} servi√ßos dispon√≠veis`);
    console.log(`- ${realBanners.length} banners promocionais`);
    console.log('‚úÖ Sistema totalmente operacional com dados reais!');

    return { success: true };

  } catch (error) {
    console.error('‚ùå Erro na configura√ß√£o:', error);
    throw error;
  }
}

// Executar se chamado diretamente
setupRealData()
  .then(() => {
    console.log('‚úÖ Setup completo finalizado com sucesso!');
    process.exit(0);
  })
  .catch((error) => {
    console.error('‚ùå Erro no setup:', error);
    process.exit(1);
  });